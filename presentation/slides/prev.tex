\section{Prevention}

\begin{frame}
\sectionpage
\end{frame}

%------------------------------------------------
\subsection{Different moments}

%------------------------------------------------
\begin{frame}
\frametitle{Different moments}
Preventing security flaws is something that has to be done during the
whole life of the application.
\begin{columns}
\begin{column}{0.5\textwidth}
\begin{itemize}
\item Architecture
\item Development
\item Maintenance
\end{itemize}
\end{column}
\begin{column}{0.5\textwidth}
\includeimage[width=\linewidth,height=0.5\textheight]{milos3d}
\end{column}
\end{columns}
\end{frame}

%------------------------------------------------
\begin{frame}
\frametitle{Architecture}
\begin{itemize}
\item Security has to be taken into account as soon as
  possible. Retrofitting security in an unsecure application is much
  more difficult than conceiving it securely from the start
\item You have to ask yourself the good questions and those questions
  vary from one application to the other
\item Know the threats you are facing
\item There is no miracle receipt... just guidelines
\end{itemize}
\note{
	Question examples:
	\begin{itemize}
	\item Who are the end-users?
	\item In what environment will the application run?
	\item Who has access to the data?
	\end{itemize}
	Source:
	\url{https://www.owasp.org/index.php/Application_Security_Architecture_Cheat_Sheet}
}
\end{frame}

%------------------------------------------------
\begin{frame}
\frametitle{Development: implementation tricks}

There are lots of best practices that can make your application more
secure.

\begin{itemize}
\item Passwords: enforcing a minimum complexity policy, storing them securely,
having the user rotate them, preventing brute-force by implementing temporary
lock-out, ...
\item Session management: setting an inactivity time out, setting the
\emph{secure} flag for sensitive cookies, using the \emph{HTTP-Only} flag for
cookies, implementing an easily accessible logout, ...
\item Input validation: always on server side, use a positive
  approach
\item Use ad-hoc protection for known attacks
\end{itemize}
\note{
	Ad-hoc protection means a protection specialized for a particular attack
	in this context.
}
\end{frame}

%------------------------------------------------
\begin{frame}
\frametitle{Development: secure development cycle}
A secure development cycle should set aside some time for:
\begin{itemize}
\item Code review \small{(security oriented and general)}
\item Pentesting
\item Security training of the developers
\item Choosing a secure and well maintained framework
	%(more on frameworks later)
\item Devising a secure configuration for deployment
\end{itemize}

\end{frame}

%------------------------------------------------
\begin{frame}
\frametitle{Maintenance}
When vulnerabilities have been discovered they have to be patched as soon as
possible.

Beware of regressions and new security breaches.

\begin{block}{Virtual Patching}
Virtual Patching is a security policy layer that prevents the exploitation of a known
vulnerability until a patch is released. It does so by filtering the
traffic that goes to and from the application server and blocking
requests that are exploits.
\end{block}

\end{frame}

%------------------------------------------------
\subsection{Using frameworks}

%------------------------------------------------
\begin{frame}
\frametitle{Frameworks}
\begin{itemize}
\item Your application is not the first
\item Frameworks ease development while providing security mechanisms
\end{itemize}
\begin{block}{Some security mechanisms}
\begin{itemize}
\item Authentication support
\item Escaping of values
\item Standard input validation
\end{itemize}
\end{block}
\begin{block}{Disadvantages}
\begin{itemize}
\item Changing a framework may prove difficult
\item Bug in a framework is known
	(version management needed)
\end{itemize}
\end{block}
\end{frame}

%------------------------------------------------
\begin{frame}
\frametitle{Frameworks - examples}

\begin{exampleblock}{Spring}
Spring is one of the most used framework for developing web application using
Java. It does feature many components including some dedicated to security.
\end{exampleblock}

\begin{exampleblock}{ESAPI}
The OWASP Enterprise Security API is a free, open source, web application
security control library that is designed to make it easier for programmers
to retrofit security into existing applications.
The ESAPI libraries also serve as a solid foundation for new development.
\end{exampleblock}

\end{frame}

%------------------------------------------------
\subsection{Security in application servers}

%------------------------------------------------
\begin{frame}
\frametitle{Security in application servers}
Application servers offer various services that can help you configure
web applications.

\begin{itemize}
\item Authentication management
\item Directory listing disabling
\item User session management
\item Error handling
\item Input encoding
\item etc.
\end{itemize}
\end{frame}

%------------------------------------------------
\subsection{Application Firewall}

%------------------------------------------------
\begin{frame}
\frametitle{Web Application Firewall}
\textbf{Web Application Firewall} (WAF) are filters which inspects the traffic
that goes in and out your application and are able to block inappropriate
content.

\begin{block}{Some features}
\begin{itemize}
\item Virtual patching
\item Scanning content
%\item Detecting connection patterns
% Masked as it is explained in detection
\end{itemize}
\end{block}
\end{frame}

%------------------------------------------------
\subsection{HTTPS}

%------------------------------------------------
\begin{frame}
\frametitle{HTTPS}
\textbf{TLS} (Transport Layer Security) is the successor of \textbf{SSL}
(Secured Socket Layer).
Equal in terms of security.
The main difference: TLS begins with an insecure "hello".
\begin{block}{What provides HTTPS?}
HTTPS provides \emph{encryption} and \emph{authentication} for HTTP.
\newline Protects against eavesdropping and spoofing.
\end{block}
\vspace{1em}
HTTPS is a part of a solution, it does not ensure full security.
\end{frame}

%------------------------------------------------
\subsection{Browser restrictions}

%------------------------------------------------
\begin{frame}
\frametitle{Browser restrictions}
\begin{itemize}
\item Cross-domain XMLHttpRequest (XHR) is disabled by default
	\\ Exceptions defined using \texttt{Access-Control}
\item Possibility of disabling JavaScript and plug-ins (Flash)
\item Private navigation mode
	\\ Does not store data on the disk
\item Cookies access is limited by
	\begin{itemize}
	\item URL
	\item Timestamp
	\item Flags (Secure, HTTP-Only)
	\end{itemize}
\item SSL Certificates are validated
\item Blacklists of known rogue sites
\end{itemize}
\note{
	XHR allows retrieving pages using JavaScript.
}
\end{frame}

%------------------------------------------------
\subsection{E-mail}

%------------------------------------------------
\begin{frame}
\frametitle{E-mail}
\begin{center}
E-mail is one of the most used application.
\par
And it's plagued by spam and spoofing.
\end{center}
\begin{block}{Sender Policy Framework (SPF)}
SPF validates e-mails by verifying sender's IP address against DNS records.
Administrators can define allowed hosts.
\begin{quote}
ietf.org. IN SPF "v=spf1 ip4:64.170.98.0/26 ip4:64.170.98.64/28 ip4:64.170.98.80/28 ip6:2001:1890:1112:1::0/64 -all"
\end{quote}
\end{block}
\end{frame}

\begin{frame}
\frametitle{E-mail}
\begin{block}{Domain Keys Identified Mail (DKIM)}
DKIM associates domain names and email messages using a digital signature
added to the header of messages, a public key is added to the DNS record of the
domain for the recipient to read the message's header.
\begin{quote}
DKIM-Signature: v=1; a=rsa-sha256; d=example.net; s=brisbane;
c=relaxed/simple; q=dns/txt; l=1234; t=1117574938; x=1118006938;
h=from:to:subject:date:keywords:keywords;
bh=MTIzNDU2Nzg5MDEyMzQ1Njc4OTAxMjM0NTY3ODkwMTI=;
b=dzdVyOfAKCdLXdJOc9G2q8LoXSlEniSbav+yuU4zGeeruD00lszZVoG4ZHRNiYzR
\end{quote}
\end{block}
\end{frame}

%------------------------------------------------
\subsection{Variety of environments}

%------------------------------------------------
\begin{frame}
\frametitle{Variety of environments}
\begin{center}
Impossible to test all the setups.
\end{center}
\begin{itemize}
\item Servers \small{(and their configuration)}
\item Networks
\item Clients
	\begin{itemize}
	\item Browsers
		\\ hacks \small{(example: IE6)} are just more code to test
	\item Mobile
	\item M2M
	\end{itemize}
\end{itemize}
\note{
	\begin{itemize}
	\item Networks: proxy, caches, etc.
	\item M2M: Machine to Machine
	\end{itemize}
}
\end{frame}

